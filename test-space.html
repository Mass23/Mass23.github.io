<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Babylon.js Room with YouTube Videos</title>
    <style>
        body { margin: 0; overflow: hidden; }
        #startButton {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 40px;
            font-size: 20px;
            background-color: #444;
            color: white;
            border: none;
            cursor: pointer;
            display: block;
        }
        #startButton.hidden { display: none; }
        .video-frame {
            position: absolute;
            pointer-events: none; /* makes the iframe non-clickable */
            border: none;
        }
    </style>
</head>
<body>
    <button id="startButton">Start</button>
    <canvas id="renderCanvas"></canvas>
    
    <!-- Babylon.js CDN -->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>

    <script>
        document.getElementById('startButton').addEventListener('click', () => {
            document.getElementById('startButton').classList.add('hidden');
            createScene();
        });

        function createScene() {
            const canvas = document.getElementById("renderCanvas");
            const engine = new BABYLON.Engine(canvas, true);
            const scene = new BABYLON.Scene(engine);
            scene.clearColor = new BABYLON.Color3(0, 0, 0);

            // Camera setup with boundaries
            const camera = new BABYLON.UniversalCamera("camera", new BABYLON.Vector3(0, 1.5, -3), scene);
            camera.attachControl(canvas, true);
            camera.speed = 0.1;
            camera.minZ = 0.1; // near clipping plane
            camera.lowerBetaLimit = BABYLON.Tools.ToRadians(45);
            camera.upperBetaLimit = BABYLON.Tools.ToRadians(135);
            camera.lowerRadiusLimit = 0.1;
            camera.upperRadiusLimit = 10;

            // Room walls, ceiling, and floor
            const room = BABYLON.MeshBuilder.CreateBox("room", {width: 8, depth: 10, height: 4}, scene);
            room.material = new BABYLON.StandardMaterial("roomMat", scene);
            room.material.diffuseColor = new BABYLON.Color3(0.05, 0.05, 0.05);
            room.invertU = true;

            // Front and back "screens" (HTML overlay for YouTube videos)
            createVideoElement("frontVideo", "https://www.youtube.com/embed/Y6I8SPj4gZ0", 4, 4.95, 0);
            createVideoElement("backVideo", "https://www.youtube.com/embed/Y6I8SPj4gZ0", 4, -4.95, 0);

            function createVideoElement(id, src, x, y, rotationY) {
                const iframe = document.createElement('iframe');
                iframe.src = src + "?autoplay=1&mute=1";
                iframe.width = width;
                iframe.height = height;
                iframe.classList.add("video-frame");
                document.body.appendChild(iframe);

                // Position iframe over scene canvas at the correct 3D position
                iframe.style.left = `${canvas.getBoundingClientRect().left + x}px`;
                iframe.style.top = `${canvas.getBoundingClientRect().top + y}px`;
                iframe.style.transform = `rotateY(${rotationY}deg)`;
            }

            // Adding images to right wall
            const images = ['identity1.webp', 'identity2.webp', 'identity3.webp'];
            images.forEach((img, i) => {
                const imgTexture = new BABYLON.Texture(`images/${img}`, scene);
                const imagePlane = BABYLON.MeshBuilder.CreatePlane(`image${i}`, { width: 1.5, height: 1.5 }, scene);
                imagePlane.material = new BABYLON.StandardMaterial(`imageMat${i}`, scene);
                imagePlane.material.diffuseTexture = imgTexture;
                imagePlane.position.set(3.95, 7 - (i*2), 1.75);
                imagePlane.rotation.y = -Math.PI / 2;
            });

            // Lights
            const videoLight1 = new BABYLON.PointLight("videoLight1", new BABYLON.Vector3(4, 5, 1.75), scene);
            const videoLight2 = new BABYLON.PointLight("videoLight2", new BABYLON.Vector3(4, -5, 1.75), scene);
            const imageLight = new BABYLON.PointLight("imageLight", new BABYLON.Vector3(8, 5, 1.75), scene);

            engine.runRenderLoop(() => scene.render());
            window.addEventListener("resize", () => engine.resize());
        }
    </script>
</body>
</html>
